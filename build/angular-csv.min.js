/*! angular-csv 14-05-2014 */
csv.directive("csv",["save",function(a){return{restrict:"AC",scope:{csvData:"&",csvFilename:"@",csvHeader:"&",csvDelimiter:"@",csvSeparator:"@"},link:function(b,c){c.bind("click",function(){a(b.data(),{filename:b.csvFilename,header:b.csvHeader(),delimiter:b.csvDelimiter,separator:b.csvSeparator})})}}}]),csv.factory("save",function(a){"use strict";var b={makeDefaults:function(a){return a.separator=a.separator||",",a.filename=a.filename||"data.csv",a},makeDataArray:function(a,c){c=b.makeDefaults(c);var d=[];return c.header&&(a=[c.header].concat(a)),angular.forEach(a,function(a){var b=[];angular.forEach(a,function(a){"string"==typeof a&&c.delimiter&&(a=c.delimiter+a+c.delimiter),this.push(a)},b),this.push(b)},d),d},makeCsvString:function(a,c){c=b.makeDefaults(c);var d="data:text/csv;charset=utf-8,";return angular.forEach(a,function(a){d+=a.join(c.separator)+"\r\n"}),encodeURI(d)},makeAnchor:function(a,c){c=b.makeDefaults(c);var d=angular.element("<a></a>");return d.attr("download",filename),d.attr("href",a),d.css("visibility","hidden"),d.css("position","absolute"),d},appendElement:function(b){var c=angular.element(a[0].body);c.append(b)},save:function(a,c){c=b.makeDefaults(c);var d=b.makeDataArray(a,c),e=(b.makeCsvString(d,c),makeAnchor(dataString,c));appendElement(e),e.click(),e.remove()}};return b});